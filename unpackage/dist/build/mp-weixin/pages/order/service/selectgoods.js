(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/service/selectgoods"],{"2dc5":function(t,e,n){},"34f4":function(t,e,n){"use strict";n.r(e);var o=n("549f"),r=n("8395");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("a985");var a,u=n("f0c5"),s=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=s.exports},"549f":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={aicon:function(){return n.e("components/aicon/aicon").then(n.bind(null,"6387"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"4556"))}},r=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.tuikuanShow=!1},t.e1=function(e){t.tuikuanShow=!1})},i=[]},"61cd":function(t,e,n){"use strict";(function(t){n("d37c");o(n("66fd"));var e=o(n("34f4"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},8342:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;getApp();var n={data:function(){return{template:t.getStorageSync("__ddminiTemplateConfig"),orderId:"",orderType:"",orderDetail:"",selectGoodsActive:!1,tuikuanShow:!1,returnData:{order_id:"",order_total:0,return_money:0,return_total:0,return_goods:[],return_reason:"",return_pics:[]}}},onLoad:function(e){var n=this;"tk"==e.type?(t.setNavigationBarTitle({title:"选择退款商品"}),n.orderType=e.type):(t.setNavigationBarTitle({title:"选择售后商品"}),n.orderType=e.type),e.id?(n.orderId=e.id,n.getOrderDetail()):t.showModal({content:"订单不存在，请检查后重试",showCancel:!1,success:function(e){e.confirm&&t.navigateBack()}})},methods:{getOrderDetail:function(){var e=this;t.showLoading({title:"订单加载中",mask:!0}),e.Get(e.Url.orderDetail,{id:e.orderId}).then((function(n){if(0===n.code){t.hideLoading();var o=n.data;o.goods_list.forEach((function(t,n){"tk"==e.orderType?o.goods_list[n].return_apply=t.return_num:o.goods_list[n].return_apply=t.service_num})),e.orderDetail=o}}))},editGoods:function(e,n){var o=this,r=o.orderDetail.goods_list[e];if("jia"==n)if("tk"==o.orderType){if(r.return_apply>=r.return_num)return void t.showToast({title:"此商品最多可申请"+r.return_num+"件",icon:"none"});o.orderDetail.goods_list[e].return_apply++}else{if(r.return_apply>=r.service_num)return void t.showToast({title:"此商品最多可申请"+r.service_num+"件",icon:"none"});o.orderDetail.goods_list[e].return_apply++}else"jian"==n&&r.return_apply>1&&o.orderDetail.goods_list[e].return_apply--},selectGoodsTap:function(e){var n=this,o=n.orderDetail.goods_list[e];"tk"==n.orderType?o.return_num?(o.active=!o.active,n.$set(n.orderDetail.goods_list,e,o)):t.showToast({title:"不能在选择该商品",icon:"none"}):o.service_num?(o.active=!o.active,n.$set(n.orderDetail.goods_list,e,o)):t.showToast({title:"不能在选择该商品",icon:"none"}),n.checkGoodsStatus()},checkGoodsStatus:function(){var t=this,e=t.orderDetail.goods_list,n=[];e.forEach((function(t){t.active&&n.push(t)})),n.length>0?t.selectGoodsActive=!0:t.selectGoodsActive=!1},selectImagesTap:function(){var e=this,n=0===e.returnData.return_pics.length?4:4-e.returnData.return_pics.length;t.chooseImage({count:n,sizeType:["compressed"],success:function(n){var o=n.tempFilePaths;o.forEach((function(n){e.Upload(e.Url.uploadFile,n).then((function(n){0===n.code?e.returnData.return_pics.push({pic:n.url}):t.showModal({title:"上传失败",content:n.msg,showCancel:!1})}))}))}})},delImageTap:function(t){var e=this;e.returnData.return_pics.splice(t,1)},getTuikuanTap:function(){var t=this,e=t.orderDetail;t.returnData.return_money=e.total_money-e.return_money,t.returnData.return_total=e.total_money-e.return_money,t.tuikuanShow=!0},sentTuikuanTap:function(){var e=this,n=e.orderDetail,o=e.returnData,r=e.orderType,i=[];if(n.goods_list.forEach((function(t){t.active&&i.push({id:t.id,num:t.return_apply})})),0===i.length)return t.showToast({title:"未选择商品，请选择后在申请",icon:"none"});if("tk"==r&&!o.return_money)return t.showToast({title:"未填写退款金额，请填写后在申请",icon:"none"});if("tk"==r&&o.return_money>o.return_total)return t.showToast({title:"退款金额不能大于实际支付金额，请修改后在申请",icon:"none"});if(!o.return_reason)return t.showToast({title:"未填写"+("tk"==r?"退款":"售后")+"原因，请填写后在申请",icon:"none"});var a={order_id:n.id,return_goods:i,return_reason:o.return_reason,return_pics:o.return_pics};"tk"==r?(a.ctype=1,a.return_money=o.return_money):a.ctype=2,e.Post(e.Url.serviceForm,a).then((function(e){0===e.code?t.showModal({content:("tk"==r?"退款":"售后")+"申请成功，请等待商家处理，如有疑问请联系客服",showCancel:!1,success:function(e){e.confirm&&t.navigateBack()}}):t.showModal({content:e.msg,showCancel:!1})}))}}};e.default=n}).call(this,n("543d")["default"])},8395:function(t,e,n){"use strict";n.r(e);var o=n("8342"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},a985:function(t,e,n){"use strict";var o=n("2dc5"),r=n.n(o);r.a}},[["61cd","common/runtime","common/vendor"]]]);