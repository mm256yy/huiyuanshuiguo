(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{4878:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={navBar:function(){return n.e("components/navBar/navBar").then(n.bind(null,"5c00"))},aicon:function(){return n.e("components/aicon/aicon").then(n.bind(null,"6387"))},uCountDown:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-count-down/u-count-down")]).then(n.bind(null,"a4f8"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"4556"))},tabbar:function(){return n.e("components/tabbar/tabbar").then(n.bind(null,"bab2"))}},a=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.barHeight=e},t.e1=function(e){t.couponsShow=!0},t.e2=function(e){t.couponsShow=!1})},i=[]},"7a18":function(t,e,n){"use strict";n.r(e);var o=n("4878"),a=n("aeaa");for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("db16");var r,s=n("f0c5"),u=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=u.exports},8090:function(t,e,n){"use strict";(function(t){function n(t){return r(t)||i(t)||a(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function i(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function r(t){if(Array.isArray(t))return s(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=getApp(),c={data:function(){return{barHeight:0,template:"",swiperCurrent:0,swiperList:[],menuList:[],pintuanGoodsList:[],miaoshaGoodsList:[],categoryList:[],categoryNums:0,timeData:{},allGoodsList:[],userInfoData:"",storeData:"",cartNums:0,couponsData:"",couponsShow:!1}},onShareAppMessage:function(){var e=this,n=t.getStorageSync("__ddminiShopInfo"),o=e.userInfoData,a="pages/index/index";return o.profitsharing&&(a="pages/index/index?fenz="+o.id),{title:n.shop_share_title,imageUrl:n.shop_share_pic,path:a}},onShareTimeline:function(){var e=t.getStorageSync("__ddminiShopInfo");return{title:e.shop_share_title,imageUrl:e.shop_share_pic}},onLoad:function(e){var n=this,o={color:{temp_color:"#F54319",tive_color:"#FF6D20",none_color:"#BBBBBB"}};if(n.template=o,t.setStorage({key:"__ddminiTemplateConfig",data:o}),t.$on("store",(function(e){t.setStorage({key:"__ddminiStoreInfo",data:e}),n.storeData=e,n.getBannerList(),n.getPintuanGoodsList(),n.getMiaoshaGoodsList(),n.getAllGoodsList()})),e.scene){var a=decodeURIComponent(e.scene),i={};a.split(",").forEach((function(t){i[t.split("=")[0]]=t.split("=")[1]})),i.g&&t.navigateTo({url:"/pages/index/details?id="+i.g}),i.f&&t.setStorageSync("__ddminiFenzUid",i.f)}e.goods&&t.navigateTo({url:"/pages/index/details?id="+e.goods}),e.pintuan&&t.navigateTo({url:"/pages/index/pintuan?id="+e.pintuan}),e.fenz&&t.setStorageSync("__ddminiFenzUid",e.fenz),n.gteStoreList(),n.getCouponsGoods()},onShow:function(){var t=this;t.getCartList()},methods:{getCouponsGoods:function(){var t=this;t.Post(t.Url.couponsGoods,{ctype:1}).then((function(e){if(0===e.code){var n=e.data.find((function(t){return t.user_status}));n&&(t.couponsData=n)}}))},getCartList:function(){var t=this;t.Get(t.Url.cartList).then((function(e){if(0===e.code){var n=0;e.data.forEach((function(t){n+=t.num})),t.cartNums=n}}))},gteStoreList:function(){var e=this,n={};t.getLocation({complete:function(o){o.latitude&&(n.latitude=o.latitude,n.longitude=o.longitude,n.current=!0),e.Get(e.Url.storeList,n).then((function(n){0===n.code&&(n.data.length>0&&(e.storeData=n.data[0],t.setStorage({key:"__ddminiStoreInfo",data:e.storeData})),e.getBannerList(),e.getUserInfo())}))}})},getUserInfo:function(){var t=this;t.Get(t.Url.userInfo).then((function(e){0===e.code&&(t.userInfoData=e.data),t.getPintuanGoodsList(),t.getMiaoshaGoodsList(),t.getAllGoodsList()}))},swiperChange:function(t){this.swiperCurrent=t.detail.current},getBannerList:function(){var t=this,e={};t.storeData&&(e.store=t.storeData.id),t.Get(t.Url.bannerList,e).then((function(e){if(0===e.code){var n=e.data,o=n.filter((function(t){return"homeAd"===t.ctype})),a=n.filter((function(t){return"homeMu"===t.ctype}));t.swiperList=o,t.menuList=a,t.getCategoryList()}}))},getCategoryList:function(){var t=this,e={};t.storeData&&(e.store=t.storeData.id),t.Get(t.Url.categoryList,e).then((function(e){if(0===e.code){var n=e.data.filter((function(t){return"homeMu"===t.ctype})).concat(t.menuList),o=[{id:0,title:"热卖推荐"}],a=e.data.filter((function(t){return"homeAll"===t.ctype})),i=o.concat(a);t.menuList=n,t.categoryList=i}}))},getPintuanGoodsList:function(){var t=this,e={pintuan:!0,recom:!0};t.storeData&&(e.store=t.storeData.id),t.Get(t.Url.goodsList,e).then((function(e){0===e.code&&(t.pintuanGoodsList=e.data.list)}))},getMiaoshaGoodsList:function(){var t=this,e={shelf_down:!0,recom:!0};t.storeData&&(e.store=t.storeData.id),t.Get(t.Url.goodsList,e).then((function(e){if(0===e.code){var n=e.data.list,o=(new Date).getTime();n.forEach((function(t){t.time_stamp=t.shelf_down_time_stamp-o})),t.miaoshaGoodsList=n}}))},getAllGoodsList:function(){var t=this,e={page:1,sizes:50,order:3};t.categoryNums?e.category=t.categoryNums:e.recom=!0,t.storeData&&(e.store=t.storeData.id),t.Get(t.Url.goodsList,e).then((function(e){0===e.code&&(t.allGoodsList=e.data.list)}))},onChange:function(t){this.timeData=t},selectCategoryTap:function(t){this.categoryNums=t,this.allGoodsList=[],this.getAllGoodsList()},getPathTap:function(t){u.globalData.getPathTap(t)},getMemberPriceTap:function(t){var e=this,o=e.userInfoData;if(t.vip_price.length>0){if(o.level_id){var a=t.vip_price.find((function(t){return t.id===o.level_id}));return a.price}var i=t.vip_price.map((function(t){return t.price})),r=Math.max.apply(Math,n(i));return r}return""},getMenuTap:function(t){t.icon?u.globalData.getPathTap("/pages/index/category?id="+t.id):u.globalData.getPathTap(t.target_data)},getAddCartTap:function(e){var n=this;if(e.specs_status)n.getPathTap("/pages/index/details?id="+e.id);else if(e.pintuan_id||"score"===e.ctype)n.getPathTap("/pages/index/details?id="+e.id);else{var o={id:e.id,number:1};n.Get(n.Url.cartAdd,o).then((function(e){0===e.code&&(t.showToast({title:"已加入购物车"}),n.getCartList())}))}},getAddCouponsTap:function(){var e=this,n=e.couponsData;if(!u.globalData.user)return t.navigateTo({url:"/pages/user/login"});e.Get(e.Url.couponsUserAdd,{id:n.id}).then((function(n){0===n.code?(t.showToast({title:"领取成功",icon:"none"}),e.couponsShow=!1,e.couponsData=""):t.showModal({content:n.msg,showCancel:!1})}))}}};e.default=c}).call(this,n("543d")["default"])},aeaa:function(t,e,n){"use strict";n.r(e);var o=n("8090"),a=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},d037:function(t,e,n){"use strict";(function(t){n("d37c");o(n("66fd"));var e=o(n("7a18"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},db16:function(t,e,n){"use strict";var o=n("e1e6"),a=n.n(o);a.a},e1e6:function(t,e,n){}},[["d037","common/runtime","common/vendor"]]]);